{% extends "base.html" %}

{% block title %}Cambiar contraseña | YourToolQuizz{% endblock %}

{% block extra_css %}
<style>
body {
    font-family: 'Inter', sans-serif;
    background:#f5f6fa;
    display:flex;
    justify-content:center;
    align-items:center;
    min-height:100vh;
    margin:0;
}
.container {
    background:#fff;
    padding:40px;
    border-radius:20px;
    box-shadow:0 8px 24px rgba(0,0,0,0.06);
    width:100%;
    max-width:400px;
}
h2 { text-align:center; margin-bottom:24px; }
label { display:block; margin-bottom:6px; font-weight:600; }

.input-wrapper {
    display:flex;
    align-items:center;
    margin-bottom:16px;
}
.input-wrapper input {
    flex:1;
    padding:12px;
    border:1px solid #ddd;
    border-radius:12px;
    font-size:1rem;
    box-sizing:border-box;
}
.input-wrapper button.toggle-eye {
    background:none;
    border:none;
    cursor:pointer;
    padding:0;
    margin-left:8px;
    display:flex;
    align-items:center;
    justify-content:center;
}
.input-wrapper button.toggle-eye svg {
    width:24px;
    height:24px;
    fill:#888;
}
.input-wrapper button.toggle-eye:hover svg {
    fill:#000;
}

button[type="submit"] {
    width:100%;
    padding:12px;
    border:none;
    border-radius:12px;
    background:#2563eb;
    color:#fff;
    font-weight:700;
    cursor:pointer;
}
button[type="submit"]:disabled {
    background:#ccc;
    cursor:not-allowed;
}
button[type="submit"]:hover:not(:disabled) { background:#2563eb; }

.flash-message {
    text-align:center;
    padding:10px;
    border-radius:12px;
    margin-bottom:10px;
}
.flash-message.success { background-color: #d4edda; color:#155724; }
.flash-message.error { background-color: #f8d7da; color:#721c24; }

a.back {
    display:block;
    text-align:center;
    margin-top:16px;
    color:#2563eb;
    text-decoration:none;
    font-weight:600;
}
a.back:hover { text-decoration:underline; }

.validation-message {
    font-size:0.85rem;
    color:#2563eb;
    margin-top:4px;
    display:none;
}
</style>
{% endblock %}
{% block content %}

<div class="container">
    <h2>Cambiar contraseña</h2>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="flash-message {{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}
<form method="POST" action="{{ url_for('change_password') }}">
    {{ form.hidden_tag() }}

<label>Contraseña actual</label>
<div class="input-wrapper">
    {{ form.current_password(id="current_password") }}
    <button type="button" class="toggle-eye" onclick="togglePassword('current_password', this)">
        <svg viewBox="0 0 24 24">
            <path class="eye" d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zm0 13a5.5 5.5 0 1 1 0-11 5.5 5.5 0 0 1 0 11z" fill="#888"/>
            <path class="slash" d="M2 2l20 20" stroke="#888" stroke-width="2"/>
        </svg>
    </button>
</div>

    <label>Nueva contraseña</label>
    <div class="input-wrapper">
        {{ form.new_password(id="new_password") }}
        <button type="button" class="toggle-eye" onclick="togglePassword('new_password', this)">
            <svg viewBox="0 0 24 24">
                <path class="eye" d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zm0 13a5.5 5.5 0 1 1 0-11 5.5 5.5 0 0 1 0 11z" fill="#888"/>
                <path class="slash" d="M2 2l20 20" stroke="#888" stroke-width="2"/>
            </svg>
        </button>
    </div>
    <div class="validation-message" id="new-password-error"></div>

    <label>Confirmar nueva contraseña</label>
    <div class="input-wrapper">
        {{ form.confirm_password(id="confirm_password") }}
        <button type="button" class="toggle-eye" onclick="togglePassword('confirm_password', this)">
            <svg viewBox="0 0 24 24">
                <path class="eye" d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zm0 13a5.5 5.5 0 1 1 0-11 5.5 5.5 0 0 1 0 11z" fill="#888"/>
                <path class="slash" d="M2 2l20 20" stroke="#888" stroke-width="2"/>
            </svg>
        </button>
    </div>
    <div class="validation-message" id="confirm-password-error"></div>

    {{ form.submit(id="submit-btn") }}
</form>


    <a class="back" href="{{ url_for('dashboard') }}">Volver al dashboard</a>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='java/contraseña.js') }}" defer></script>

{% endblock %}