{% extends "base.html" %}

{% block title %}Homepage - YourToolQuizz{% endblock %}

{% block extra_css %}
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Inter',sans-serif;} 
body{display:flex;height:100vh;background:#f3f4f6;color:#111827;}

/* --- SIDEBAR --- */
.sidebar{
    width:300px;
    background:#ffffff;
    border-right:1px solid #e5e7eb;
    display:flex;
    flex-direction:column;
    overflow:hidden;
}
.sidebar-header{
    position:relative;
    height:150px;
    background:url('https://images.unsplash.com/photo-1503264116251-35a269479413?auto=format&fit=crop&w=1000&q=80') center/cover;
    display:flex;
    align-items:flex-end;
    padding:16px;
}
.sidebar-logo{
    width:64px;height:64px;border-radius:16px;background:#fff;border:3px solid #fff;
    position:absolute;bottom:-32px;left:16px;
}
.sidebar-title{
    margin-left:80px;font-size:20px;font-weight:700;color:#fff;text-shadow:0 1px 3px rgba(0,0,0,0.4);
}
.sidebar-content{
    margin-top:40px;padding:20px;display:flex;flex-direction:column;gap:12px;overflow-y:auto;
}
.chat-list{
    display:flex;
    flex-direction:column;
    gap:8px;
    margin-top:16px;
}
.chat-item{
    padding:10px;
    border-radius:8px;
    cursor:pointer;
    background:#f3f4f6;
    transition:0.2s;
}
.chat-item.active{
    background:#dbeafe;
    font-weight:600;
}

/* --- CHAT --- */
.chat{
    flex:1;display:flex;flex-direction:column;background:#f7f7f7;position:relative;
}
.chat-header{
    padding:16px;
    font-weight:600;
    border-bottom:1px solid #e5e7eb;
}
.chat-messages{
    flex:1;padding:20px;overflow-y:auto;display:flex;flex-direction:column;gap:12px;
}
.message-wrapper{
    display:flex;flex-direction:column;max-width:70%;animation:fadeIn .25s ease;
}
.message-wrapper.user{align-self:flex-end;}
.message-wrapper.admin{align-self:flex-start;}
.username{font-size:12px;font-weight:600;margin-bottom:4px;}
.message{
    padding:10px 16px;border-radius:16px;line-height:1.45;font-size:14px;word-wrap:break-word;
    position:relative;box-shadow:0 1px 3px rgba(0,0,0,0.1);transition:0.2s;
}
.message.user{background:#2563eb;color:#fff;}
.message.admin{background:#fff;color:#111827;}
.reaction{margin-left:6px;cursor:pointer;font-size:16px;}

/* --- INPUT --- */
.chat-input{
    display:flex;padding:14px;background:#fff;border-top:1px solid #e5e7eb;gap:12px;
}
.chat-input input{
    flex:1;padding:12px 16px;border-radius:24px;border:1px solid #d1d5db;font-size:14px;outline:none;transition:border .2s;
}
.chat-input input:focus{border-color:#2563eb;}
.chat-input button{
    padding:12px 22px;border-radius:24px;background:#2563eb;color:#fff;border:none;font-weight:600;cursor:pointer;transition:.2s;
}
.chat-input button:hover{background:#1e40af;}

/* --- SCROLL --- */
::-webkit-scrollbar{width:6px;}
::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px;}
::-webkit-scrollbar-track{background:transparent;}

/* --- ANIMACIÓN --- */
@keyframes fadeIn{from{opacity:0;transform:translateY(6px);}to{opacity:1;transform:translateY(0);}}
</style>
{% endblock %}

{% block content %}
<div class="sidebar">
  <div class="sidebar-header">
    <img src="https://i.pravatar.cc/72" class="sidebar-logo" />
    <div class="sidebar-title">MiAppX</div>
  </div>

  <div class="sidebar-content">
    <button id="new-chat-btn" class="action-btn" style="margin-bottom:12px;">+ Nuevo chat</button>

    <div class="chat-list" id="chat-list">
      <!-- Chats se cargarán aquí dinámicamente -->
    </div>
  </div>
</div>

<div class="chat">
  <div class="chat-header" id="chat-header">Selecciona un chat</div>

  <div class="chat-messages" id="messages">
    <div class="message user">Chat activo.</div>
  </div>

  <div class="chat-input">
    <input type="text" id="input" placeholder="Escribe un mensaje..." />
    <button id="send-btn">Enviar</button>
  </div>
</div>

<div id="chat" 
     data-user-id="{{ current_user.id }}" 
     data-user-name="{{ current_user.name }}">
</div>

<!-- Cargar Socket.IO -->
<script src="{{ url_for('static', filename='java/socket.io.min.js') }}"></script>
<!-- JS del chat -->
<script src="{{ url_for('static', filename='java/chat.js') }}" defer></script>
{% endblock %}
