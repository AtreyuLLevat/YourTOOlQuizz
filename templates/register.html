{% extends "base.html" %}

{% block title %}Register | YourToolQuizz{% endblock %}

{% block extra_css %}
<style>
   
    main {
      flex: 1;
      max-width: 400px;
      margin: 60px auto;
      padding: 36px 24px;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.06);
      display: flex;
      flex-direction: column;
    }

    h2 { font-size: 1.8rem; font-weight: 800; margin-bottom: 30px; color: #000; text-align: center; }

    form { display: flex; flex-direction: column; gap: 16px; }

    label { font-weight: 600; color: #111; }

    input[type="text"],
    input[type="email"],
    input[type="password"] {
      padding: 12px 14px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.3s ease;
    }
    input:focus { border-color: #D60000; outline: none; }

    button[type="submit"] {
      padding: 12px;
      background: #D60000;
      color: #fff;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    button[type="submit"]:hover { background: #ff1a1a; transform: scale(1.05); }

    .flash-message {
      padding: 10px 12px;
      border-radius: 8px;
    }
    .flash-message.success { background-color: #d4edda; color: #155724; }
    .flash-message.error { background-color: #f8d7da; color: #721c24; }

  </style>
{% endblock %}
{%block content%}

<main>
  <h2>Registro de Usuario</h2>
  <form method="POST" novalidate>
    {{ form.hidden_tag() }}

    <label for="email">Correo electrónico</label>
    {{ form.email(id="email", class="form-input") }}
    {% for e in form.email.errors %}<div class="flash-message error">{{ e }}</div>{% endfor %}

    <label for="password">Contraseña</label>
    {{ form.password(id="password", class="form-input") }}
    {% for e in form.password.errors %}<div class="flash-message error">{{ e }}</div>{% endfor %}

    <label for="confirm_password">Confirmar Contraseña</label>
    {{ form.confirm_password(id="confirm_password", class="form-input") }}
    {% for e in form.confirm_password.errors %}<div class="flash-message error">{{ e }}</div>{% endfor %}

    <button type="submit">Registrarse</button>
  </form>

  {% if qr_png %}
  <hr>
  <h3>Configura tu verificación en dos pasos</h3>
  <p>Escanea este QR con Google Authenticator / Authy:</p>
  <img alt="QR 2FA" style="max-width:240px" src="data:image/png;base64,{{ qr_png }}">
  <p>Clave secreta: <code>{{ otp_secret }}</code></p>
  <p><a href="{{ url_for('login') }}">Ir a iniciar sesión</a></p>
  {% endif %}

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="flash-message {{ category }}">{{ message }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}
</main>
{% endblock%}
